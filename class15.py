from Crypto.Util.number import *

p = getStrongPrime(512)
a = getRandomRange(2, p-2)

while(GCD(a, p-1) != 1):
    a = getRandomRange(2, p-2)

print(GCD(a, p-1))


print(a)
#loop until you get a GCD of 1 with p-1

base = 2
A = pow(base, a, p)
print("=======================")
print("base: " + str(base))
print("p: " + str(p))
print("A: " + str(A))
#print p, base, A

a = 2061566286652414750600163168781535190993481598996113972129290219706203699823851451693228750220782356908410302016476151333439425047585510062197705818503619
p = 11463606859909081147351597523462181488887469921563639668546938827885524305369212966836725576163613354650807636163797101738313006051435899180057827651860059
A = 10682867501695935209809923605279017781696912207850813582704761883533591898685469293009949734484246488845921856437707411107416892062392289051228755017600873
B = 6426715176106456637755055277716273409496104670772410091082617726504152959790182680948702433999213975705679080946256504032216813338583723341666350105943209

shared = pow(B, a, p)
print("Shared: " + str(shared))


p = 125301575591
a = 115813337451
h = 73973989900

# factors of p-1
p_1_fac = [2,5,37,41,43,47,61,67]

